env:
    config:
      robot:
        asset:
          density:
          armature:
          thickness:
          asset_root: /home/stav/dev/ProtoMotions/phys_anim/data/assets
          robot_type: smpl_humanoid
          filter_ints:
          - 0
          - 0
          - 7
          - 16
          - 12
          - 0
          - 56
          - 2
          - 33
          - 128
          - 0
          - 192
          - 0
          - 64
          - 0
          - 0
          - 0
          - 0
          - 0
          - 0
          - 0
          - 0
          - 0
          - 0
          fix_base_link:
          linear_damping:
          angular_damping:
          asset_file_name: mjcf/smpl_humanoid.xml
          disable_gravity:
          self_collisions: true
          max_linear_velocity:
          max_angular_velocity:
          collapse_fixed_joints:
          default_dof_drive_mode: 1
          flip_visual_attachments:
          replace_cylinder_with_capsule:
        control:
          damping:
          stiffness:
          action_scale: 1
          control_type: isaac_pd
          clamp_actions: 1
          isaac_pd_scale: false
        foot_name:
        init_state:
        key_bodies:
        - R_Ankle
        - L_Ankle
        - L_Hand
        - R_Hand
        num_bodies: 24
        dof_body_ids: "???"
        dof_obs_size: 138
        bfs_dof_names:
        - L_Hip_x
        - L_Hip_y
        - L_Hip_z
        - R_Hip_x
        - R_Hip_y
        - R_Hip_z
        - Torso_x
        - Torso_y
        - Torso_z
        - L_Knee_x
        - L_Knee_y
        - L_Knee_z
        - R_Knee_x
        - R_Knee_y
        - R_Knee_z
        - Spine_x
        - Spine_y
        - Spine_z
        - L_Ankle_x
        - L_Ankle_y
        - L_Ankle_z
        - R_Ankle_x
        - R_Ankle_y
        - R_Ankle_z
        - Chest_x
        - Chest_y
        - Chest_z
        - L_Toe_x
        - L_Toe_y
        - L_Toe_z
        - R_Toe_x
        - R_Toe_y
        - R_Toe_z
        - Neck_x
        - Neck_y
        - Neck_z
        - L_Thorax_x
        - L_Thorax_y
        - L_Thorax_z
        - R_Thorax_x
        - R_Thorax_y
        - R_Thorax_z
        - Head_x
        - Head_y
        - Head_z
        - L_Shoulder_x
        - L_Shoulder_y
        - L_Shoulder_z
        - R_Shoulder_x
        - R_Shoulder_y
        - R_Shoulder_z
        - L_Elbow_x
        - L_Elbow_y
        - L_Elbow_z
        - R_Elbow_x
        - R_Elbow_y
        - R_Elbow_z
        - L_Wrist_x
        - L_Wrist_y
        - L_Wrist_z
        - R_Wrist_x
        - R_Wrist_y
        - R_Wrist_z
        - L_Hand_x
        - L_Hand_y
        - L_Hand_z
        - R_Hand_x
        - R_Hand_y
        - R_Hand_z
        dfs_dof_names:
        - L_Hip_x
        - L_Hip_y
        - L_Hip_z
        - L_Knee_x
        - L_Knee_y
        - L_Knee_z
        - L_Ankle_x
        - L_Ankle_y
        - L_Ankle_z
        - L_Toe_x
        - L_Toe_y
        - L_Toe_z
        - R_Hip_x
        - R_Hip_y
        - R_Hip_z
        - R_Knee_x
        - R_Knee_y
        - R_Knee_z
        - R_Ankle_x
        - R_Ankle_y
        - R_Ankle_z
        - R_Toe_x
        - R_Toe_y
        - R_Toe_z
        - Torso_x
        - Torso_y
        - Torso_z
        - Spine_x
        - Spine_y
        - Spine_z
        - Chest_x
        - Chest_y
        - Chest_z
        - Neck_x
        - Neck_y
        - Neck_z
        - Head_x
        - Head_y
        - Head_z
        - L_Thorax_x
        - L_Thorax_y
        - L_Thorax_z
        - L_Shoulder_x
        - L_Shoulder_y
        - L_Shoulder_z
        - L_Elbow_x
        - L_Elbow_y
        - L_Elbow_z
        - L_Wrist_x
        - L_Wrist_y
        - L_Wrist_z
        - L_Hand_x
        - L_Hand_y
        - L_Hand_z
        - R_Thorax_x
        - R_Thorax_y
        - R_Thorax_z
        - R_Shoulder_x
        - R_Shoulder_y
        - R_Shoulder_z
        - R_Elbow_x
        - R_Elbow_y
        - R_Elbow_z
        - R_Wrist_x
        - R_Wrist_y
        - R_Wrist_z
        - R_Hand_x
        - R_Hand_y
        - R_Hand_z
        self_obs_size: 358
        bfs_body_names:
        - Pelvis
        - L_Hip
        - R_Hip
        - Torso
        - L_Knee
        - R_Knee
        - Spine
        - L_Ankle
        - R_Ankle
        - Chest
        - L_Toe
        - R_Toe
        - Neck
        - L_Thorax
        - R_Thorax
        - Head
        - L_Shoulder
        - R_Shoulder
        - L_Elbow
        - R_Elbow
        - L_Wrist
        - R_Wrist
        - L_Hand
        - R_Hand
        contact_bodies:
        - Pelvis
        - L_Hip
        - R_Hip
        - Torso
        - L_Knee
        - R_Knee
        - Spine
        - L_Ankle
        - R_Ankle
        - Chest
        - L_Toe
        - R_Toe
        - Neck
        - L_Thorax
        - R_Thorax
        - Head
        - L_Shoulder
        - R_Shoulder
        - L_Elbow
        - R_Elbow
        - L_Wrist
        - R_Wrist
        - L_Hand
        - R_Hand
        dfs_body_names:
        - Pelvis
        - L_Hip
        - L_Knee
        - L_Ankle
        - L_Toe
        - R_Hip
        - R_Knee
        - R_Ankle
        - R_Toe
        - Torso
        - Spine
        - Chest
        - Neck
        - Head
        - L_Thorax
        - L_Shoulder
        - L_Elbow
        - L_Wrist
        - L_Hand
        - R_Thorax
        - R_Shoulder
        - R_Elbow
        - R_Wrist
        - R_Hand
        left_foot_name: L_Ankle
        num_key_bodies: 4
        right_foot_name: R_Ankle
        dfs_dof_body_ids:
        - 1
        - 2
        - 3
        - 4
        - 5
        - 6
        - 7
        - 8
        - 9
        - 10
        - 11
        - 12
        - 13
        - 14
        - 15
        - 16
        - 17
        - 18
        - 19
        - 20
        - 21
        - 22
        - 23
        number_of_actions: 69
        contact_pairs_multiplier: 16
        self_obs_max_coords_size: 358
        mimic_small_marker_bodies:
        non_termination_contact_bodies:
        - R_Ankle
        - L_Ankle
        - R_Toe
        - L_Toe
      camera:
      terrain:
        config:
          map_width: 20
          map_length: 20
          num_levels: 10
          border_size: 40
          load_terrain: false
          num_terrains: 10
          sample_width: 1
          save_terrain: false
          terrain_path:
          vertical_scale: 0.005
          slope_threshold: 0.9
          horizontal_scale: 0.1
          terrain_composition: curriculum
          terrain_proportions:
          - 0.2
          - 0.1
          - 0.1
          - 0.1
          - 0.05
          - 0
          - 0
          - 0.45
          num_samples_per_axis: 16
          spacing_between_scenes: 5
          terrain_obs_num_samples: 256
          minimal_humanoid_spacing: 0
        _target_: phys_anim.envs.env_utils.terrains.terrain.Terrain
      backbone: isaacgym
      headless: true
      num_envs: 128
      scene_lib:
      simulator:
        sim:
          fps: 60
          flex:
            warm_start: 0.25
            num_inner_iterations: 10
          physx:
            num_threads: 4
            rest_offset: 0
            solver_type: 1
            contact_offset: 0.02
            num_position_iterations: 4
            num_velocity_iterations: 0
            bounce_threshold_velocity: 0.2
            max_depenetration_velocity: 10
            default_buffer_size_multiplier: 10
          substeps: 2
          control_freq_inv: 2
        plane:
          restitution: 0
          static_friction: 1
          dynamic_friction: 1
      motion_lib:
        _target_: phys_anim.utils.motion_lib.MotionLib
        motion_file: /home/stav/dev/ProtoMotions/phys_anim/data/motions/smpl_humanoid_walk.npy
        ref_height_adjust: 0
        fix_motion_heights: true
      state_init: Random
      sync_motion: false
      export_video: false
      humanoid_obs:
        local_root_obs: true
        root_height_obs: true
        use_max_coords_obs: true
      object_types:
      - Armchairs
      - StraightChairs
      - HighStools
      - LowStools
      - Sofas
      - Tables
      - LargeSofas
      export_motion: false
      output_motion: false
      record_viewer: false
      task_reward_w: 1
      experiment_name: inversion_steering_root_and_head_coords_speed_4to6_bigger_encoder
      fixed_motion_id:
      steering_params:
        obs_size: 3
        log_speed: false
        tar_speed_max: 6
        tar_speed_min: 4
        change_steps_max: 200
        change_steps_min: 199
        stop_probability: 0.05
        enable_rand_heading: true
        use_current_pose_obs: true
        standard_speed_change: 0.3
        standard_heading_change: 1.57
        heading_change_steps_max: 150
        heading_change_steps_min: 40
        random_heading_probability: 0.2
      hybrid_init_prob: 0
      masked_mimic_obs:
        num_future_steps: 10
        num_obs_per_joint: 24
        text_embedding_dim: 512
        num_obs_per_target_pose: 576
        num_historical_stored_steps: 120
        object_bounding_box_obs_dim: 37
        historical_obs_size_per_pose: 217
        num_obs_per_sparse_target_pose: 184
        num_historical_conditioned_steps: 15
        masked_mimic_target_poses_num_steps: 11
        masked_mimic_report_full_body_metrics: true
      mimic_reset_track:
        steps_max: 600
        steps_min: 10
        grace_period: 5
        reset_on_episode_reset: false
        reset_episode_on_reset_track: true
      mimic_target_pose:
        type: max-coords-future-rel
        enabled: true
        with_time: false
        num_future_steps: 10
        target_pose_type: max-coords
        num_obs_per_joint: 18
        num_obs_per_target_pose: 432
        base_num_obs_per_target_pose: 432
      viewer_record_dir: output/recordings/viewer
      visualize_markers: true
      force_flat_terrain: false
      max_episode_length: 1000
      ref_respawn_offset: 0.25
      termination_height: 0.15
      mimic_reward_config:
        add_rr_to_lr: true
        sum_before_exp: true
        relative_kb_pos: false
        tan_norm_reward: false
        rt_ignore_height: true
        component_weights:
          dv_rew_w: 0
          gr_rew_w: 0.3
          gt_rew_w: 0.5
          gv_rew_w: 0.1
          kb_rew_w: 0
          lr_rew_w: 0
          rh_rew_w: 0.2
          rt_rew_w: 0
          rv_rew_w: 0
          gav_rew_w: 0.1
          kbf_rew_w: 0
          pow_rew_w: 0.0005
          rav_rew_w: 0
        positive_constant: 0
        component_coefficients:
          dv_rew_c: -0.005
          gr_rew_c: -2
          gt_rew_c: -100
          gv_rew_c: -0.5
          kb_rew_c: -100
          lr_rew_c: -2
          rh_rew_c: -100
          rt_rew_c: -120
          rv_rew_c: -1
          gav_rew_c: -0.1
          kbf_rew_c: -0.01
          rav_rew_c: -0.3
        unequal_reward_joint_weights: false
      motion_index_offset:
      masked_mimic_masking:
        joint_masking:
          masked_mimic_time_mask: true
          time_gap_mask_max_steps: 11
          time_gap_mask_min_steps: 1
          masked_mimic_fixed_conditioning:
          force_max_conditioned_bodies_prob: 0.1
          masked_mimic_time_gap_probability: 0.1
          masked_mimic_repeat_mask_probability: 0.98
          with_conditioning_max_gap_probability: 0.2
          force_small_num_conditioned_bodies_prob: 0.1
          with_conditioning_time_gap_mask_max_steps: 44
        target_pose_joint_probs: 0
        target_pose_visible_prob: 0
        start_without_history_prob: 0
        object_bounding_box_visible_prob: 0.8
        motion_text_embeddings_visible_prob: 0.5
      disable_discriminator: false  # to run PULSE
      mimic_motion_sampling:
        init_start_prob: 0.15
        init_random_prob: 0.05
      mimic_dynamic_sampling:
        enabled: true
        bucket_width: 2
        min_bucket_weight: 1.0e-06
        sampling_criteria: mimic_early_termination
        dynamic_weight_max:
        dynamic_weight_pow: 1
        update_dynamic_weight_epochs: 5
      mimic_residual_control: false
      head_termination_height: 0.3
      mimic_early_termination:
      enable_height_termination: false
      object_ref_respawn_offset: 0.1
      shield_termination_height: 0.32
      mimic_conditionable_bodies:
      mimic_fixed_motion_per_env: false
      discriminator_obs_size_per_step: 232
      masked_mimic_conditionable_bodies:
      - L_Ankle
      - R_Ankle
      - Pelvis
      - Head
      - L_Hand
      - R_Hand
      discriminator_obs_historical_steps: 10
    _target_: phys_anim.envs.masked_mimic_inversion.steering.isaacgym.MaskedMimicDirectionHumanoid
    _recursive_: false
algo:
    config:
      tau: 0.95
      vae:
        vae_noise_type: zeros
        vae_kld_schedule:
          end_epoch: 6000
          start_epoch: 3000
          end_kld_coeff: 0.01
          init_kld_coeff: 0.0001
      actor:
        config:
          mu_model:
            config:
              units:
              - 1024
              - 1024
              - 1024
              activation: relu
              initializer: default
              extra_inputs:
                terrain:
                  config:
                    normalize_obs: false
                    obs_clamp_value:
                  num_in: 256
                  num_out: 256
                  _target_: phys_anim.agents.models.common.Flatten
                vae_latent:
                  config:
                    units:
                    - 256
                    - 128
                    activation: relu
                    initializer: default
                    normalize_obs: false
                    use_layer_norm: false
                    obs_clamp_value:
                  num_in: 64
                  num_out: 64
                  _target_: phys_anim.agents.models.mlp.MLP_WithNorm
              normalize_obs: true
              terrain_model:
                config:
                  normalize_obs: false
                  obs_clamp_value:
                num_in: 256
                num_out: 256
                _target_: phys_anim.agents.models.common.Flatten
              use_layer_norm: false
              obs_clamp_value:
              transformer_token_size: 512
            _target_: phys_anim.agents.models.mlp.MultiHeadedMLP
            _recursive_: false
          vae_prior:
            config:
              trunk:
                config:
                  units:
                  - 256
                  - 256
                  dropout: 0
                  ff_size: 1024
                  obs_mlp:
                    units:
                    - 256
                    - 256
                    activation: relu
                    initializer: default
                    normalize_obs: true
                    use_layer_norm: false
                    obs_clamp_value:
                  num_heads: 4
                  activation: relu
                  latent_dim: 512
                  num_layers: 4
                  output_mlp:
                    units:
                    - 1
                    num_out: 64
                    activation: relu
                    initializer: default
                    normalize_obs: false
                    use_layer_norm: false
                    obs_clamp_value:
                  initializer: default
                  extra_inputs:
                    terrain:
                      config:
                        units:
                        - 256
                        - 256
                        activation: relu
                        operations:
                        - type: encode
                        - type: reshape
                          new_shape:
                          - batch_size
                          - 1
                          - 512
                        initializer: default
                        normalize_obs: true
                        use_layer_norm: false
                        obs_clamp_value:
                        encoder_input_dim: 256
                      num_in: 256
                      num_out: 512
                      _target_: phys_anim.agents.models.mlp.MLP_WithNorm
                    inversion_obs:
                      config:
                        units:
                        - 512
                        - 512
                        - 512
                        activation: relu
                        operations:
                        - type: encode
                        - type: reshape
                          new_shape:
                          - batch_size
                          - 1
                          - 512
                        initializer: default
                        normalize_obs: true
                        use_layer_norm: false
                        obs_clamp_value:
                        encoder_input_dim: 9
                      num_in: 9
                      num_out: 512
                      _target_: phys_anim.agents.models.mlp.MLP_WithNorm
                    historical_pose_obs:
                      config:
                        units:
                        - 256
                        - 256
                        mask_key: historical_pose_obs_mask
                        activation: relu
                        operations:
                        - type: reshape
                          new_shape:
                          - -1
                          - 217
                        - type: encode
                        - type: reshape
                          new_shape:
                          - batch_size
                          - 15
                          - 512
                        initializer: default
                        normalize_obs: true
                        use_layer_norm: false
                        obs_clamp_value:
                        encoder_input_dim: 217
                        mask_valid_as_zeros: false
                      num_in: 3255
                      num_out: 512
                      _target_: phys_anim.agents.models.mlp.MLP_WithNorm
                    motion_text_embeddings:
                      config:
                        units:
                        - 256
                        - 256
                        mask_key: motion_text_embeddings_mask
                        activation: relu
                        operations:
                        - type: encode
                        - type: reshape
                          new_shape:
                          - batch_size
                          - 1
                          - 512
                        initializer: default
                        normalize_obs: true
                        use_layer_norm: false
                        obs_clamp_value:
                        encoder_input_dim: 512
                        mask_valid_as_zeros: false
                      num_in: 512
                      num_out: 512
                      _target_: phys_anim.agents.models.mlp.MLP_WithNorm
                    object_bounding_box_obs:
                      config:
                        units:
                        - 256
                        - 256
                        mask_key: object_bounding_box_obs_mask
                        activation: relu
                        operations:
                        - type: encode
                        - type: reshape
                          new_shape:
                          - batch_size
                          - 1
                          - 512
                        initializer: default
                        normalize_obs: true
                        use_layer_norm: false
                        obs_clamp_value:
                        encoder_input_dim: 37
                        mask_valid_as_zeros: false
                      num_in: 37
                      num_out: 512
                      _target_: phys_anim.agents.models.mlp.MLP_WithNorm
                    historical_pose_obs_mask:
                      config:
                        dtype: bool
                        normalize_obs: false
                        obs_clamp_value:
                      num_in: 15
                      num_out: 15
                      _target_: phys_anim.agents.models.common.Flatten
                    masked_mimic_target_poses:
                      config:
                        units:
                        - 256
                        - 256
                        mask_key: masked_mimic_target_poses_masks
                        activation: relu
                        operations:
                        - type: reshape
                          new_shape:
                          - -1
                          - 184
                        - type: encode
                        - type: reshape
                          new_shape:
                          - batch_size
                          - 11
                          - 512
                        initializer: default
                        normalize_obs: true
                        use_layer_norm: false
                        obs_clamp_value:
                        encoder_input_dim: 184
                        mask_valid_as_zeros: false
                        obs_per_body_controller: 12
                      num_in: 2024
                      num_out: 512
                      _target_: phys_anim.agents.models.mlp.MLP_WithNorm
                    motion_text_embeddings_mask:
                      config:
                        dtype: bool
                        normalize_obs: false
                        obs_clamp_value:
                      num_in: 1
                      num_out: 1
                      _target_: phys_anim.agents.models.common.Flatten
                    object_bounding_box_obs_mask:
                      config:
                        dtype: bool
                        normalize_obs: false
                        obs_clamp_value:
                      num_in: 1
                      num_out: 1
                      _target_: phys_anim.agents.models.common.Flatten
                    masked_mimic_target_poses_masks:
                      config:
                        dtype: bool
                        normalize_obs: false
                        obs_clamp_value:
                      num_in: 11
                      num_out: 11
                      _target_: phys_anim.agents.models.common.Flatten
                  normalize_obs: true
                  terrain_model:
                    config:
                      units:
                      - 256
                      - 256
                      activation: relu
                      operations:
                      - type: encode
                      - type: reshape
                        new_shape:
                        - batch_size
                        - 1
                        - 512
                      initializer: default
                      normalize_obs: true
                      use_layer_norm: false
                      obs_clamp_value:
                      encoder_input_dim: 256
                    num_in: 256
                    num_out: 512
                    _target_: phys_anim.agents.models.mlp.MLP_WithNorm
                  output_decoder: false
                  use_layer_norm: false
                  obs_clamp_value:
                  num_future_steps: 10
                  type_embedding_dim: 0
                  num_obs_per_target_pose: 184
                num_out: 512
                _target_: phys_anim.agents.models.transformer.TransformerWithNorm
                _recursive_: false
              outputs:
                mu:
                  config:
                    units:
                    - 256
                    - 128
                    activation: relu
                    initializer: default
                    normalize_obs: false
                    use_layer_norm: false
                    obs_clamp_value:
                  num_in: 512
                  num_out: 64
                  _target_: phys_anim.agents.models.mlp.MLP_WithNorm
                logvar:
                  config:
                    units:
                    - 256
                    - 128
                    activation: relu
                    initializer: default
                    normalize_obs: false
                    use_layer_norm: false
                    obs_clamp_value:
                  num_in: 512
                  num_out: 64
                  _target_: phys_anim.agents.models.mlp.MLP_WithNorm
              normalize_obs: false
              obs_clamp_value:
            num_out: 64
            _target_: phys_anim.agents.models.mlp.MultiOutputNetwork
            _recursive_: false
          activation: relu
          init_logstd: -2.9
          initializer: default
          vae_encoder:
            config:
              trunk:
                config:
                  units:
                  - 1024
                  - 1024
                  - 1024
                  activation: relu
                  initializer: default
                  extra_inputs:
                    terrain:
                      config:
                        normalize_obs: false
                        obs_clamp_value:
                      num_in: 256
                      num_out: 256
                      _target_: phys_anim.agents.models.common.Flatten
                    mimic_target_poses:
                      config:
                        normalize_obs: true
                        obs_clamp_value:
                      num_in: 4320
                      num_out: 4320
                      _target_: phys_anim.agents.models.common.Flatten
                    masked_mimic_target_bodies_masks:
                      config:
                        dtype: bool
                        normalize_obs: false
                        obs_clamp_value:
                      num_in: 140
                      num_out: 140
                      _target_: phys_anim.agents.models.common.Flatten
                  normalize_obs: true
                  use_layer_norm: false
                  obs_clamp_value:
                num_out: 1024
                _target_: phys_anim.agents.models.mlp.MultiHeadedMLP
                _recursive_: false
              outputs:
                mu:
                  config:
                    units:
                    - 512
                    activation: relu
                    initializer: default
                    normalize_obs: false
                    use_layer_norm: false
                    obs_clamp_value:
                  num_in: 1024
                  num_out: 64
                  _target_: phys_anim.agents.models.mlp.MLP_WithNorm
                logvar:
                  config:
                    units:
                    - 512
                    activation: relu
                    initializer: default
                    normalize_obs: false
                    use_layer_norm: false
                    obs_clamp_value:
                  num_in: 1024
                  num_out: 64
                  _target_: phys_anim.agents.models.mlp.MLP_WithNorm
              normalize_obs: false
              obs_clamp_value:
            num_out: 64
            _target_: phys_anim.agents.models.mlp.MultiOutputNetwork
            _recursive_: false
          sigma_schedule:
          use_layer_norm: false
          vae_latent_dim: 64
          learnable_sigma: false
          residual_encoder: true
          vae_latent_from_prior: true
        _target_: phys_anim.agents.models.actor.ActorFixedSigmaVAE
        _recursive_: false
      gamma: 0.99
      critic:
        config:
          units:
          - 1024
          - 1024
          - 1024
          activation: relu
          initializer: default
          extra_inputs:
            inversion_obs:
              config:
                normalize_obs: false
                obs_clamp_value:
              num_in: 9
              num_out: 9
              _target_: phys_anim.agents.models.common.Flatten
          normalize_obs: true
          use_layer_norm: false
          obs_clamp_value:
        _target_: phys_anim.agents.models.critic.CriticMLP
        _recursive_: false
      dagger:
        only_bc: false
        bc_coeff: 0
        gt_actor_path:
        collect_data_with_expert: false
      e_clip: 0.2
      models:
        terrain_models:
          mlp:
            config:
              normalize_obs: false
              obs_clamp_value:
            num_in: 256
            num_out: 256
            _target_: phys_anim.agents.models.common.Flatten
          transformer:
            config:
              units:
              - 256
              - 256
              activation: relu
              operations:
              - type: encode
              - type: reshape
                new_shape:
                - batch_size
                - 1
                - 512
              initializer: default
              normalize_obs: true
              use_layer_norm: false
              obs_clamp_value:
              encoder_input_dim: 256
            num_in: 256
            num_out: 512
            _target_: phys_anim.agents.models.mlp.MLP_WithNorm
        vae_prior_model:
          config:
            trunk:
              config:
                units:
                - 256
                - 256
                dropout: 0
                ff_size: 1024
                obs_mlp:
                  units:
                  - 256
                  - 256
                  activation: relu
                  initializer: default
                  normalize_obs: true
                  use_layer_norm: false
                  obs_clamp_value:
                num_heads: 4
                activation: relu
                latent_dim: 512
                num_layers: 4
                output_mlp:
                  units:
                  - 1
                  num_out: 64
                  activation: relu
                  initializer: default
                  normalize_obs: false
                  use_layer_norm: false
                  obs_clamp_value:
                initializer: default
                extra_inputs:
                  terrain:
                    config:
                      units:
                      - 256
                      - 256
                      activation: relu
                      operations:
                      - type: encode
                      - type: reshape
                        new_shape:
                        - batch_size
                        - 1
                        - 512
                      initializer: default
                      normalize_obs: true
                      use_layer_norm: false
                      obs_clamp_value:
                      encoder_input_dim: 256
                    num_in: 256
                    num_out: 512
                    _target_: phys_anim.agents.models.mlp.MLP_WithNorm
                  inversion_obs:
                    config:
                      units:
                      - 512
                      - 512
                      - 512
                      activation: relu
                      operations:
                      - type: encode
                      - type: reshape
                        new_shape:
                        - batch_size
                        - 1
                        - 512
                      initializer: default
                      normalize_obs: true
                      use_layer_norm: false
                      obs_clamp_value:
                      encoder_input_dim: 9
                    num_in: 9
                    num_out: 512
                    _target_: phys_anim.agents.models.mlp.MLP_WithNorm
                  historical_pose_obs:
                    config:
                      units:
                      - 256
                      - 256
                      mask_key: historical_pose_obs_mask
                      activation: relu
                      operations:
                      - type: reshape
                        new_shape:
                        - -1
                        - 217
                      - type: encode
                      - type: reshape
                        new_shape:
                        - batch_size
                        - 15
                        - 512
                      initializer: default
                      normalize_obs: true
                      use_layer_norm: false
                      obs_clamp_value:
                      encoder_input_dim: 217
                      mask_valid_as_zeros: false
                    num_in: 3255
                    num_out: 512
                    _target_: phys_anim.agents.models.mlp.MLP_WithNorm
                  motion_text_embeddings:
                    config:
                      units:
                      - 256
                      - 256
                      mask_key: motion_text_embeddings_mask
                      activation: relu
                      operations:
                      - type: encode
                      - type: reshape
                        new_shape:
                        - batch_size
                        - 1
                        - 512
                      initializer: default
                      normalize_obs: true
                      use_layer_norm: false
                      obs_clamp_value:
                      encoder_input_dim: 512
                      mask_valid_as_zeros: false
                    num_in: 512
                    num_out: 512
                    _target_: phys_anim.agents.models.mlp.MLP_WithNorm
                  object_bounding_box_obs:
                    config:
                      units:
                      - 256
                      - 256
                      mask_key: object_bounding_box_obs_mask
                      activation: relu
                      operations:
                      - type: encode
                      - type: reshape
                        new_shape:
                        - batch_size
                        - 1
                        - 512
                      initializer: default
                      normalize_obs: true
                      use_layer_norm: false
                      obs_clamp_value:
                      encoder_input_dim: 37
                      mask_valid_as_zeros: false
                    num_in: 37
                    num_out: 512
                    _target_: phys_anim.agents.models.mlp.MLP_WithNorm
                  historical_pose_obs_mask:
                    config:
                      dtype: bool
                      normalize_obs: false
                      obs_clamp_value:
                    num_in: 15
                    num_out: 15
                    _target_: phys_anim.agents.models.common.Flatten
                  masked_mimic_target_poses:
                    config:
                      units:
                      - 256
                      - 256
                      mask_key: masked_mimic_target_poses_masks
                      activation: relu
                      operations:
                      - type: reshape
                        new_shape:
                        - -1
                        - 184
                      - type: encode
                      - type: reshape
                        new_shape:
                        - batch_size
                        - 11
                        - 512
                      initializer: default
                      normalize_obs: true
                      use_layer_norm: false
                      obs_clamp_value:
                      encoder_input_dim: 184
                      mask_valid_as_zeros: false
                      obs_per_body_controller: 12
                    num_in: 2024
                    num_out: 512
                    _target_: phys_anim.agents.models.mlp.MLP_WithNorm
                  motion_text_embeddings_mask:
                    config:
                      dtype: bool
                      normalize_obs: false
                      obs_clamp_value:
                    num_in: 1
                    num_out: 1
                    _target_: phys_anim.agents.models.common.Flatten
                  object_bounding_box_obs_mask:
                    config:
                      dtype: bool
                      normalize_obs: false
                      obs_clamp_value:
                    num_in: 1
                    num_out: 1
                    _target_: phys_anim.agents.models.common.Flatten
                  masked_mimic_target_poses_masks:
                    config:
                      dtype: bool
                      normalize_obs: false
                      obs_clamp_value:
                    num_in: 11
                    num_out: 11
                    _target_: phys_anim.agents.models.common.Flatten
                normalize_obs: true
                terrain_model:
                  config:
                    units:
                    - 256
                    - 256
                    activation: relu
                    operations:
                    - type: encode
                    - type: reshape
                      new_shape:
                      - batch_size
                      - 1
                      - 512
                    initializer: default
                    normalize_obs: true
                    use_layer_norm: false
                    obs_clamp_value:
                    encoder_input_dim: 256
                  num_in: 256
                  num_out: 512
                  _target_: phys_anim.agents.models.mlp.MLP_WithNorm
                output_decoder: false
                use_layer_norm: false
                obs_clamp_value:
                num_future_steps: 10
                type_embedding_dim: 0
                num_obs_per_target_pose: 184
              num_out: 512
              _target_: phys_anim.agents.models.transformer.TransformerWithNorm
              _recursive_: false
            outputs:
              mu:
                config:
                  units:
                  - 256
                  - 128
                  activation: relu
                  initializer: default
                  normalize_obs: false
                  use_layer_norm: false
                  obs_clamp_value:
                num_in: 512
                num_out: 64
                _target_: phys_anim.agents.models.mlp.MLP_WithNorm
              logvar:
                config:
                  units:
                  - 256
                  - 128
                  activation: relu
                  initializer: default
                  normalize_obs: false
                  use_layer_norm: false
                  obs_clamp_value:
                num_in: 512
                num_out: 64
                _target_: phys_anim.agents.models.mlp.MLP_WithNorm
            normalize_obs: false
            obs_clamp_value:
          num_out: 64
          _target_: phys_anim.agents.models.mlp.MultiOutputNetwork
          _recursive_: false
        vae_latent_model:
          config:
            units:
            - 256
            - 128
            activation: relu
            initializer: default
            normalize_obs: false
            use_layer_norm: false
            obs_clamp_value:
          num_in: 64
          num_out: 64
          _target_: phys_anim.agents.models.mlp.MLP_WithNorm
        extra_input_model:
          config:
            normalize_obs: false
            obs_clamp_value:
          num_in: 9
          num_out: 9
          _target_: phys_anim.agents.models.common.Flatten
        vae_encoder_model:
          config:
            trunk:
              config:
                units:
                - 1024
                - 1024
                - 1024
                activation: relu
                initializer: default
                extra_inputs:
                  terrain:
                    config:
                      normalize_obs: false
                      obs_clamp_value:
                    num_in: 256
                    num_out: 256
                    _target_: phys_anim.agents.models.common.Flatten
                  mimic_target_poses:
                    config:
                      normalize_obs: true
                      obs_clamp_value:
                    num_in: 4320
                    num_out: 4320
                    _target_: phys_anim.agents.models.common.Flatten
                  masked_mimic_target_bodies_masks:
                    config:
                      dtype: bool
                      normalize_obs: false
                      obs_clamp_value:
                    num_in: 140
                    num_out: 140
                    _target_: phys_anim.agents.models.common.Flatten
                normalize_obs: true
                use_layer_norm: false
                obs_clamp_value:
              num_out: 1024
              _target_: phys_anim.agents.models.mlp.MultiHeadedMLP
              _recursive_: false
            outputs:
              mu:
                config:
                  units:
                  - 512
                  activation: relu
                  initializer: default
                  normalize_obs: false
                  use_layer_norm: false
                  obs_clamp_value:
                num_in: 1024
                num_out: 64
                _target_: phys_anim.agents.models.mlp.MLP_WithNorm
              logvar:
                config:
                  units:
                  - 512
                  activation: relu
                  initializer: default
                  normalize_obs: false
                  use_layer_norm: false
                  obs_clamp_value:
                num_in: 1024
                num_out: 64
                _target_: phys_anim.agents.models.mlp.MLP_WithNorm
            normalize_obs: false
            obs_clamp_value:
          num_out: 64
          _target_: phys_anim.agents.models.mlp.MultiOutputNetwork
          _recursive_: false
        prior_output_units:
        - 256
        - 128
        prior_pre_processor:
          config:
            units:
            - 256
            - 256
            dropout: 0
            ff_size: 1024
            obs_mlp:
              units:
              - 256
              - 256
              activation: relu
              initializer: default
              normalize_obs: true
              use_layer_norm: false
              obs_clamp_value:
            num_heads: 4
            activation: relu
            latent_dim: 512
            num_layers: 4
            output_mlp:
              units:
              - 1
              num_out: 64
              activation: relu
              initializer: default
              normalize_obs: false
              use_layer_norm: false
              obs_clamp_value:
            initializer: default
            extra_inputs:
              terrain:
                config:
                  units:
                  - 256
                  - 256
                  activation: relu
                  operations:
                  - type: encode
                  - type: reshape
                    new_shape:
                    - batch_size
                    - 1
                    - 512
                  initializer: default
                  normalize_obs: true
                  use_layer_norm: false
                  obs_clamp_value:
                  encoder_input_dim: 256
                num_in: 256
                num_out: 512
                _target_: phys_anim.agents.models.mlp.MLP_WithNorm
              inversion_obs:
                config:
                  units:
                  - 512
                  - 512
                  - 512
                  activation: relu
                  operations:
                  - type: encode
                  - type: reshape
                    new_shape:
                    - batch_size
                    - 1
                    - 512
                  initializer: default
                  normalize_obs: true
                  use_layer_norm: false
                  obs_clamp_value:
                  encoder_input_dim: 9
                num_in: 9
                num_out: 512
                _target_: phys_anim.agents.models.mlp.MLP_WithNorm
              historical_pose_obs:
                config:
                  units:
                  - 256
                  - 256
                  mask_key: historical_pose_obs_mask
                  activation: relu
                  operations:
                  - type: reshape
                    new_shape:
                    - -1
                    - 217
                  - type: encode
                  - type: reshape
                    new_shape:
                    - batch_size
                    - 15
                    - 512
                  initializer: default
                  normalize_obs: true
                  use_layer_norm: false
                  obs_clamp_value:
                  encoder_input_dim: 217
                  mask_valid_as_zeros: false
                num_in: 3255
                num_out: 512
                _target_: phys_anim.agents.models.mlp.MLP_WithNorm
              motion_text_embeddings:
                config:
                  units:
                  - 256
                  - 256
                  mask_key: motion_text_embeddings_mask
                  activation: relu
                  operations:
                  - type: encode
                  - type: reshape
                    new_shape:
                    - batch_size
                    - 1
                    - 512
                  initializer: default
                  normalize_obs: true
                  use_layer_norm: false
                  obs_clamp_value:
                  encoder_input_dim: 512
                  mask_valid_as_zeros: false
                num_in: 512
                num_out: 512
                _target_: phys_anim.agents.models.mlp.MLP_WithNorm
              object_bounding_box_obs:
                config:
                  units:
                  - 256
                  - 256
                  mask_key: object_bounding_box_obs_mask
                  activation: relu
                  operations:
                  - type: encode
                  - type: reshape
                    new_shape:
                    - batch_size
                    - 1
                    - 512
                  initializer: default
                  normalize_obs: true
                  use_layer_norm: false
                  obs_clamp_value:
                  encoder_input_dim: 37
                  mask_valid_as_zeros: false
                num_in: 37
                num_out: 512
                _target_: phys_anim.agents.models.mlp.MLP_WithNorm
              historical_pose_obs_mask:
                config:
                  dtype: bool
                  normalize_obs: false
                  obs_clamp_value:
                num_in: 15
                num_out: 15
                _target_: phys_anim.agents.models.common.Flatten
              masked_mimic_target_poses:
                config:
                  units:
                  - 256
                  - 256
                  mask_key: masked_mimic_target_poses_masks
                  activation: relu
                  operations:
                  - type: reshape
                    new_shape:
                    - -1
                    - 184
                  - type: encode
                  - type: reshape
                    new_shape:
                    - batch_size
                    - 11
                    - 512
                  initializer: default
                  normalize_obs: true
                  use_layer_norm: false
                  obs_clamp_value:
                  encoder_input_dim: 184
                  mask_valid_as_zeros: false
                  obs_per_body_controller: 12
                num_in: 2024
                num_out: 512
                _target_: phys_anim.agents.models.mlp.MLP_WithNorm
              motion_text_embeddings_mask:
                config:
                  dtype: bool
                  normalize_obs: false
                  obs_clamp_value:
                num_in: 1
                num_out: 1
                _target_: phys_anim.agents.models.common.Flatten
              object_bounding_box_obs_mask:
                config:
                  dtype: bool
                  normalize_obs: false
                  obs_clamp_value:
                num_in: 1
                num_out: 1
                _target_: phys_anim.agents.models.common.Flatten
              masked_mimic_target_poses_masks:
                config:
                  dtype: bool
                  normalize_obs: false
                  obs_clamp_value:
                num_in: 11
                num_out: 11
                _target_: phys_anim.agents.models.common.Flatten
            normalize_obs: true
            terrain_model:
              config:
                units:
                - 256
                - 256
                activation: relu
                operations:
                - type: encode
                - type: reshape
                  new_shape:
                  - batch_size
                  - 1
                  - 512
                initializer: default
                normalize_obs: true
                use_layer_norm: false
                obs_clamp_value:
                encoder_input_dim: 256
              num_in: 256
              num_out: 512
              _target_: phys_anim.agents.models.mlp.MLP_WithNorm
            output_decoder: false
            use_layer_norm: false
            obs_clamp_value:
            num_future_steps: 10
            type_embedding_dim: 0
            num_obs_per_target_pose: 184
          num_out: 512
          _target_: phys_anim.agents.models.transformer.TransformerWithNorm
          _recursive_: false
        encoder_output_units:
        - 512
        extra_input_obs_size: 9
        encoder_pre_processor:
          config:
            units:
            - 1024
            - 1024
            - 1024
            activation: relu
            initializer: default
            extra_inputs:
              terrain:
                config:
                  normalize_obs: false
                  obs_clamp_value:
                num_in: 256
                num_out: 256
                _target_: phys_anim.agents.models.common.Flatten
              mimic_target_poses:
                config:
                  normalize_obs: true
                  obs_clamp_value:
                num_in: 4320
                num_out: 4320
                _target_: phys_anim.agents.models.common.Flatten
              masked_mimic_target_bodies_masks:
                config:
                  dtype: bool
                  normalize_obs: false
                  obs_clamp_value:
                num_in: 140
                num_out: 140
                _target_: phys_anim.agents.models.common.Flatten
            normalize_obs: true
            use_layer_norm: false
            obs_clamp_value:
          num_out: 1024
          _target_: phys_anim.agents.models.mlp.MultiHeadedMLP
          _recursive_: false
        transformer_obs_units:
        - 256
        - 256
        mimic_target_pose_model:
          config:
            normalize_obs: true
            obs_clamp_value:
          num_in: 4320
          num_out: 4320
          _target_: phys_anim.agents.models.common.Flatten
        prior_preprocessor_units:
        - 256
        - 256
        encoder_preprocessor_units:
        - 1024
        - 1024
        - 1024
        historical_poses_mask_model:
          config:
            dtype: bool
            normalize_obs: false
            obs_clamp_value:
          num_in: 15
          num_out: 15
          _target_: phys_anim.agents.models.common.Flatten
        prior_preprocessor_output_dim: 1024
        masked_mimic_target_pose_model:
          config:
            units:
            - 256
            - 256
            mask_key: masked_mimic_target_poses_masks
            activation: relu
            operations:
            - type: reshape
              new_shape:
              - -1
              - 184
            - type: encode
            - type: reshape
              new_shape:
              - batch_size
              - 11
              - 512
            initializer: default
            normalize_obs: true
            use_layer_norm: false
            obs_clamp_value:
            encoder_input_dim: 184
            mask_valid_as_zeros: false
            obs_per_body_controller: 12
          num_in: 2024
          num_out: 512
          _target_: phys_anim.agents.models.mlp.MLP_WithNorm
        object_bounding_box_mask_model:
          config:
            dtype: bool
            normalize_obs: false
            obs_clamp_value:
          num_in: 1
          num_out: 1
          _target_: phys_anim.agents.models.common.Flatten
        encoder_preprocessor_output_dim: 1024
        extra_input_model_for_transformer:
          config:
            units:
            - 512
            - 512
            - 512
            activation: relu
            operations:
            - type: encode
            - type: reshape
              new_shape:
              - batch_size
              - 1
              - 512
            initializer: default
            normalize_obs: true
            use_layer_norm: false
            obs_clamp_value:
            encoder_input_dim: 9
          num_in: 9
          num_out: 512
          _target_: phys_anim.agents.models.mlp.MLP_WithNorm
        motion_text_embeddings_mask_model:
          config:
            dtype: bool
            normalize_obs: false
            obs_clamp_value:
          num_in: 1
          num_out: 1
          _target_: phys_anim.agents.models.common.Flatten
        masked_mimic_target_poses_mask_model:
          config:
            dtype: bool
            normalize_obs: false
            obs_clamp_value:
          num_in: 11
          num_out: 11
          _target_: phys_anim.agents.models.common.Flatten
        masked_mimic_target_bodies_mask_model:
          config:
            dtype: bool
            normalize_obs: false
            obs_clamp_value:
          num_in: 140
          num_out: 140
          _target_: phys_anim.agents.models.common.Flatten
        historical_poses_for_transformer_model:
          config:
            units:
            - 256
            - 256
            mask_key: historical_pose_obs_mask
            activation: relu
            operations:
            - type: reshape
              new_shape:
              - -1
              - 217
            - type: encode
            - type: reshape
              new_shape:
              - batch_size
              - 15
              - 512
            initializer: default
            normalize_obs: true
            use_layer_norm: false
            obs_clamp_value:
            encoder_input_dim: 217
            mask_valid_as_zeros: false
          num_in: 3255
          num_out: 512
          _target_: phys_anim.agents.models.mlp.MLP_WithNorm
        object_bounding_box_for_transformer_model:
          config:
            units:
            - 256
            - 256
            mask_key: object_bounding_box_obs_mask
            activation: relu
            operations:
            - type: encode
            - type: reshape
              new_shape:
              - batch_size
              - 1
              - 512
            initializer: default
            normalize_obs: true
            use_layer_norm: false
            obs_clamp_value:
            encoder_input_dim: 37
            mask_valid_as_zeros: false
          num_in: 37
          num_out: 512
          _target_: phys_anim.agents.models.mlp.MLP_WithNorm
        motion_text_embeddings_for_transformer_model:
          config:
            units:
            - 256
            - 256
            mask_key: motion_text_embeddings_mask
            activation: relu
            operations:
            - type: encode
            - type: reshape
              new_shape:
              - batch_size
              - 1
              - 512
            initializer: default
            normalize_obs: true
            use_layer_norm: false
            obs_clamp_value:
            encoder_input_dim: 512
            mask_valid_as_zeros: false
          num_in: 512
          num_out: 512
          _target_: phys_anim.agents.models.mlp.MLP_WithNorm
      num_games:
      num_steps: 32
      schedules:
      batch_size: 128
      max_epochs: 305175
      eval_length:
      extra_inputs:
        terrain:
          size: 256
          dtype: float
          env_obs_name: terrain_obs
          retrieve_from_env: true
        vae_latent:
          size: 64
          dtype: float
          retrieve_from_env: false
        inversion_obs:
          size: 9
          dtype: float
          retrieve_from_env: true
        mimic_target_poses:
          size: 4320
          dtype: float
          retrieve_from_env: true
        historical_pose_obs:
          size: 3255
          dtype: float
          retrieve_from_env: true
        motion_text_embeddings:
          size: 512
          dtype: float
          retrieve_from_env: true
        object_bounding_box_obs:
          size: 37
          dtype: float
          retrieve_from_env: true
        historical_pose_obs_mask:
          size: 15
          dtype: bool
          retrieve_from_env: true
        masked_mimic_target_poses:
          size: 2024
          dtype: float
          retrieve_from_env: true
        motion_text_embeddings_mask:
          size: 1
          dtype: bool
          retrieve_from_env: true
        object_bounding_box_obs_mask:
          size: 1
          dtype: bool
          retrieve_from_env: true
        masked_mimic_target_poses_masks:
          size: 11
          dtype: bool
          retrieve_from_env: true
        masked_mimic_target_bodies_masks:
          size: 140
          dtype: bool
          retrieve_from_env: true
      discriminator:
        config:
          units:
          - 1
          activation: relu
          initializer: default
          extra_inputs:
          normalize_obs: true
          use_layer_norm: false
          obs_clamp_value:
          discriminator_obs_historical_steps: 10
        _target_: phys_anim.agents.models.discriminator.JointDiscMLP
        _recursive_: false
      normalize_obs: true
      task_reward_w: 1
      check_grad_mag: true
      eval_callbacks:
      max_eval_steps:
      actor_optimizer:
        lr: 2.0e-05
        betas:
        - 0.9
        - 0.999
        _target_: torch.optim.Adam
      num_mini_epochs: 6
      obs_clamp_value:
      val_clamp_value:
      bounds_loss_coef: 10
      clip_critic_loss: true
      critic_optimizer:
        lr: 0.0001
        betas:
        - 0.9
        - 0.999
        _target_: torch.optim.Adam
      eval_metric_keys: []
      normalize_values: true
      eval_num_episodes: 1
      fail_on_bad_grads: false
      gradient_clip_val: 50
      manual_save_every: 10
      actor_lr_scheduler:
      eval_metrics_every: 500
      critic_lr_scheduler:
      normalize_advantage: true
      use_rand_action_masks: false
      discriminator_reward_w: 2
      discriminator_optimizer:
        lr: 0
        betas:
        - 0.9
        - 0.999
        _target_: torch.optim.Adam
        _recursive_: false
      discriminator_batch_size: 4096
      discriminator_replay_size: 200000
      discriminator_grad_penalty: 5
      discriminator_lr_scheduler:
      discriminator_weight_decay: 0.0001
      training_early_termination:
        early_terminate_cart_err:
        early_terminate_reward_too_bad_prob:
      gradient_accumulation_steps: 1
      pre_trained_maskedmimic_path: data/pretrained_models/MaskedMimic/last.ckpt
      num_discriminator_mini_epochs: 3
      discriminator_replay_keep_prob: 0.01
      discriminator_logit_weight_decay: 0.01
    _target_: phys_anim.agents.masked_mimic_finetune.MimicFinetune
    _recursive_: false
ngpu: 1
seed: 0
nodes: 1
robot:
    asset:
      density:
      armature:
      thickness:
      asset_root: /home/stav/dev/ProtoMotions/phys_anim/data/assets
      robot_type: smpl_humanoid
      filter_ints:
      - 0
      - 0
      - 7
      - 16
      - 12
      - 0
      - 56
      - 2
      - 33
      - 128
      - 0
      - 192
      - 0
      - 64
      - 0
      - 0
      - 0
      - 0
      - 0
      - 0
      - 0
      - 0
      - 0
      - 0
      fix_base_link:
      linear_damping:
      angular_damping:
      asset_file_name: mjcf/smpl_humanoid.xml
      disable_gravity:
      self_collisions: true
      max_linear_velocity:
      max_angular_velocity:
      collapse_fixed_joints:
      default_dof_drive_mode: 1
      flip_visual_attachments:
      replace_cylinder_with_capsule:
    control:
      damping:
      stiffness:
      action_scale: 1
      control_type: isaac_pd
      clamp_actions: 1
      isaac_pd_scale: false
    foot_name:
    init_state:
    key_bodies:
    - R_Ankle
    - L_Ankle
    - L_Hand
    - R_Hand
    num_bodies: 24
    dof_body_ids: "???"
    dof_obs_size: 138
    bfs_dof_names:
    - L_Hip_x
    - L_Hip_y
    - L_Hip_z
    - R_Hip_x
    - R_Hip_y
    - R_Hip_z
    - Torso_x
    - Torso_y
    - Torso_z
    - L_Knee_x
    - L_Knee_y
    - L_Knee_z
    - R_Knee_x
    - R_Knee_y
    - R_Knee_z
    - Spine_x
    - Spine_y
    - Spine_z
    - L_Ankle_x
    - L_Ankle_y
    - L_Ankle_z
    - R_Ankle_x
    - R_Ankle_y
    - R_Ankle_z
    - Chest_x
    - Chest_y
    - Chest_z
    - L_Toe_x
    - L_Toe_y
    - L_Toe_z
    - R_Toe_x
    - R_Toe_y
    - R_Toe_z
    - Neck_x
    - Neck_y
    - Neck_z
    - L_Thorax_x
    - L_Thorax_y
    - L_Thorax_z
    - R_Thorax_x
    - R_Thorax_y
    - R_Thorax_z
    - Head_x
    - Head_y
    - Head_z
    - L_Shoulder_x
    - L_Shoulder_y
    - L_Shoulder_z
    - R_Shoulder_x
    - R_Shoulder_y
    - R_Shoulder_z
    - L_Elbow_x
    - L_Elbow_y
    - L_Elbow_z
    - R_Elbow_x
    - R_Elbow_y
    - R_Elbow_z
    - L_Wrist_x
    - L_Wrist_y
    - L_Wrist_z
    - R_Wrist_x
    - R_Wrist_y
    - R_Wrist_z
    - L_Hand_x
    - L_Hand_y
    - L_Hand_z
    - R_Hand_x
    - R_Hand_y
    - R_Hand_z
    dfs_dof_names:
    - L_Hip_x
    - L_Hip_y
    - L_Hip_z
    - L_Knee_x
    - L_Knee_y
    - L_Knee_z
    - L_Ankle_x
    - L_Ankle_y
    - L_Ankle_z
    - L_Toe_x
    - L_Toe_y
    - L_Toe_z
    - R_Hip_x
    - R_Hip_y
    - R_Hip_z
    - R_Knee_x
    - R_Knee_y
    - R_Knee_z
    - R_Ankle_x
    - R_Ankle_y
    - R_Ankle_z
    - R_Toe_x
    - R_Toe_y
    - R_Toe_z
    - Torso_x
    - Torso_y
    - Torso_z
    - Spine_x
    - Spine_y
    - Spine_z
    - Chest_x
    - Chest_y
    - Chest_z
    - Neck_x
    - Neck_y
    - Neck_z
    - Head_x
    - Head_y
    - Head_z
    - L_Thorax_x
    - L_Thorax_y
    - L_Thorax_z
    - L_Shoulder_x
    - L_Shoulder_y
    - L_Shoulder_z
    - L_Elbow_x
    - L_Elbow_y
    - L_Elbow_z
    - L_Wrist_x
    - L_Wrist_y
    - L_Wrist_z
    - L_Hand_x
    - L_Hand_y
    - L_Hand_z
    - R_Thorax_x
    - R_Thorax_y
    - R_Thorax_z
    - R_Shoulder_x
    - R_Shoulder_y
    - R_Shoulder_z
    - R_Elbow_x
    - R_Elbow_y
    - R_Elbow_z
    - R_Wrist_x
    - R_Wrist_y
    - R_Wrist_z
    - R_Hand_x
    - R_Hand_y
    - R_Hand_z
    self_obs_size: 358
    bfs_body_names:
    - Pelvis
    - L_Hip
    - R_Hip
    - Torso
    - L_Knee
    - R_Knee
    - Spine
    - L_Ankle
    - R_Ankle
    - Chest
    - L_Toe
    - R_Toe
    - Neck
    - L_Thorax
    - R_Thorax
    - Head
    - L_Shoulder
    - R_Shoulder
    - L_Elbow
    - R_Elbow
    - L_Wrist
    - R_Wrist
    - L_Hand
    - R_Hand
    contact_bodies:
    - Pelvis
    - L_Hip
    - R_Hip
    - Torso
    - L_Knee
    - R_Knee
    - Spine
    - L_Ankle
    - R_Ankle
    - Chest
    - L_Toe
    - R_Toe
    - Neck
    - L_Thorax
    - R_Thorax
    - Head
    - L_Shoulder
    - R_Shoulder
    - L_Elbow
    - R_Elbow
    - L_Wrist
    - R_Wrist
    - L_Hand
    - R_Hand
    dfs_body_names:
    - Pelvis
    - L_Hip
    - L_Knee
    - L_Ankle
    - L_Toe
    - R_Hip
    - R_Knee
    - R_Ankle
    - R_Toe
    - Torso
    - Spine
    - Chest
    - Neck
    - Head
    - L_Thorax
    - L_Shoulder
    - L_Elbow
    - L_Wrist
    - L_Hand
    - R_Thorax
    - R_Shoulder
    - R_Elbow
    - R_Wrist
    - R_Hand
    left_foot_name: L_Ankle
    num_key_bodies: 4
    right_foot_name: R_Ankle
    dfs_dof_body_ids:
    - 1
    - 2
    - 3
    - 4
    - 5
    - 6
    - 7
    - 8
    - 9
    - 10
    - 11
    - 12
    - 13
    - 14
    - 15
    - 16
    - 17
    - 18
    - 19
    - 20
    - 21
    - 22
    - 23
    number_of_actions: 69
    contact_pairs_multiplier: 16
    self_obs_max_coords_size: 358
    mimic_small_marker_bodies:
    non_termination_contact_bodies:
    - R_Ankle
    - L_Ankle
    - R_Toe
    - L_Toe
wandb:
    wandb_id:
    wandb_tags:
    wandb_group:
    wandb_entity:
    wandb_project: physical_animation
_wandb:
    m:
    - '1': env/total_rew_mean
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': trainer/global_step
      '6':
      - 3
      '7': []
    - '1': rewards/task_rewards
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': actor/extra_loss
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': times/fps_last_epoch
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': critic/grad_norm_after_clip
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': env/bucket_weights_min
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': critic/grad_norm_before_clip
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': epoch
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': env/terminate_frac
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': actor/logstd_min
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': env/bucket_scores_mean
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': env/bucket_frames_spent_max
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': env/bucket_added_weights_min
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': eval/success_rate
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': info/episode_length
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': eval/speed_error_std
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': rewards/total_rewards
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': actor/grad_norm_before_clip
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': actor/ppo_loss
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': env/bucket_average_score_min
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': env/bucket_average_score_mean
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': env/bucket_scores_min
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': actor/bounds_loss
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': actor/grad_norm_after_clip
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': env/bucket_frames_spent_mean
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': env/bucket_frames_spent_min
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': times/training_minutes
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': env/bucket_weights_mean
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': eval/direction_error_std
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': env/bucket_added_weights_max
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': eval/direction_error_mean
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': actor/logstd_max
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': actor/clip_frac
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': actor/logstd_mean
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': info/gframes
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': info/episode_reward
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': actor/vae_kld_loss
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': actor/bad_grads_count
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': actor/kld_coeff
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': losses/actor_loss
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': actor/bc_loss
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': losses/critic_loss
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': critic/bad_grads_count
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': env/bucket_weights_max
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': env/bucket_added_weights_mean
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': eval/speed_error_mean
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': info/frames
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': env/action_clamp_frac
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': times/last_epoch_seconds
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': rewards/extra_rewards
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': env/bucket_scores_max
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': env/bucket_average_score_max
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': times/training_hours
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    - '1': times/fps_total
      '5': 2
      '6':
      - 1
      - 3
      '7': []
    t:
      '1':
      - 1
      - 9
      - 11
      - 49
      - 50
      - 55
      - 103
      - 106
      '2':
      - 1
      - 9
      - 11
      - 49
      - 50
      - 55
      - 103
      - 106
      '3':
      - 7
      - 13
      - 23
      - 55
      - 60
      - 66
      '4': 3.8.20
      '5': 0.18.5
      '6': 4.46.1
      '8':
      - 5
      '9':
        '2': lightning_fabric_logger
      '12': 0.18.5
      '13': linux-x86_64
    cli_version: 0.18.5
    python_version: 3.8.20
device: 2
fabric:
    devices: 1
    loggers:
    - _target_: lightning.fabric.loggers.TensorBoardLogger
      root_dir: results/inversion_steering_root_and_head_coords_speed_4to6_bigger_encoder
    - id:
      name: inversion_steering_root_and_head_coords_speed_4to6_bigger_encoder
      tags:
      group:
      entity:
      resume: allow
      project: physical_animation
      _target_: wandb.integration.lightning.fabric.WandbLogger
      save_dir: results/inversion_steering_root_and_head_coords_speed_4to6_bigger_encoder
    _target_: lightning.fabric.Fabric
    strategy:
      device: 2
      _target_: lightning.fabric.strategies.SingleDeviceStrategy
    _convert_: all
    callbacks:
    - _target_: agents.callbacks.save_best_reward_model.SaveBestModelCallback
    num_nodes: 1
    precision: 32-true
    accelerator: gpu
terrain:
    config:
      map_width: 20
      map_length: 20
      num_levels: 10
      border_size: 40
      load_terrain: false
      num_terrains: 10
      sample_width: 1
      save_terrain: false
      terrain_path:
      vertical_scale: 0.005
      slope_threshold: 0.9
      horizontal_scale: 0.1
      terrain_composition: curriculum
      terrain_proportions:
      - 0.2
      - 0.1
      - 0.1
      - 0.1
      - 0.05
      - 0
      - 0
      - 0.45
      num_samples_per_axis: 16
      spacing_between_scenes: 5
      terrain_obs_num_samples: 256
      minimal_humanoid_spacing: 0
    _target_: phys_anim.envs.env_utils.terrains.terrain.Terrain
backbone: isaacgym
base_dir: results
headless: true
num_envs: 128
save_dir: results/inversion_steering_root_and_head_coords_speed_4to6_bigger_encoder
scene_lib:
checkpoint:
motion_lib:
    _target_: phys_anim.utils.motion_lib.MotionLib
    motion_file: /home/stav/dev/ProtoMotions/phys_anim/data/motions/smpl_humanoid_walk.npy
    ref_height_adjust: 0
    fix_motion_heights: true
scene_file: /home/stav/dev/data/yaml_files/samp_scenes_train.yaml
motion_file: /home/stav/dev/ProtoMotions/phys_anim/data/motions/smpl_humanoid_walk.npy
amp_precision: 32-true
gt_actor_path:
eval_overrides:
    env:
      config:
        mimic_reset_track:
          steps_max: 1000001
          steps_min: 1000000
        max_episode_length: 10000
        masked_mimic_masking:
          start_without_history_prob: 0
        mimic_motion_sampling:
          init_start_prob: 1
          init_random_prob: 0
        mimic_dynamic_sampling:
          enabled: false
        mimic_early_termination:
        enable_height_termination: false
        mimic_fixed_motion_per_env: false
    algo:
      config:
        dagger:
          collect_data_with_expert: false
    ngpu: 1
    nodes: 1
    fabric:
      loggers:
    headless: false
    num_envs: 1
    scene_file: data/yaml_files/samp_scenes_test.yaml
    gt_actor_path:
    vae_noise_type: zeros
    auto_load_latest: false
    vae_latent_from_prior: true
    pre_trained_maskedmimic_path:
    masked_mimic_report_full_body_metrics: false
vae_noise_type: zeros
experiment_name: inversion_steering_root_and_head_coords_speed_4to6_bigger_encoder
auto_load_latest: false
codebase_version: 1
eval_metrics_every: 999999999999
force_flat_terrain: false
ref_respawn_offset: 0.25
training_max_steps: 10000000000
torch_deterministic: false
vae_latent_from_prior: true
pre_trained_maskedmimic_path: data/pretrained_models/MaskedMimic/last.ckpt
masked_mimic_report_full_body_metrics: true
